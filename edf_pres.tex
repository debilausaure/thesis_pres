\documentclass[xetex,notheorems,hyperref={pdfpagelabels=true},xcolor={table},aspectratio=169]{beamer}
\usetheme{minflat}
\usepackage{booktabs}
\usepackage[scale=2]{ccicons}

\usepackage[style=american]{csquotes}

\usetikzlibrary{decorations.pathreplacing, decorations.pathmorphing,calc,arrows,positioning,patterns,fadings,shadows, arrows.meta}
\tikzset{
    %Define standard arrow tip
    >=stealth'
}


\tikzfading[name=fade right, left color=transparent!0, right color=transparent!100]
\tikzfading[name=fade left, left color=transparent!100, right color=transparent!0]
\tikzfading[name=fade out, inner color=transparent!0, outer color=transparent!100]

%define hatched pattern
\pgfdeclarepatternformonly{south west lines}{\pgfqpoint{-0pt}{-0pt}}{\pgfqpoint{3pt}{3pt}}{\pgfqpoint{3pt}{3pt}}{
        \pgfsetlinewidth{0.4pt}
        \pgfpathmoveto{\pgfqpoint{0pt}{0pt}}
        \pgfpathlineto{\pgfqpoint{3pt}{3pt}}
        \pgfpathmoveto{\pgfqpoint{2.8pt}{-.2pt}}
        \pgfpathlineto{\pgfqpoint{3.2pt}{.2pt}}
        \pgfpathmoveto{\pgfqpoint{-.2pt}{2.8pt}}
        \pgfpathlineto{\pgfqpoint{.2pt}{3.2pt}}
        \pgfusepath{stroke}}

\setbeamercovered{invisible}

%%% enable notes on second screen
%\usepackage{pgfpages}
%\setbeameroption{show notes on second screen=right}
%\setbeamertemplate{note page}[compress]

\definecolor{proofgreen}{RGB}{233,4,105}
\definecolor{implementation}{RGB}{41,2,81}
	
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	define content of title page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\talkTitle{Formal Correctness Proof for an EDF Scheduler Implementation}
\def\talkSubtitle{RTAS 2022}
\def\talkKeywords{Keywords}

%% Define meta data of pdf
\hypersetup{
    pdftitle={Slides to talk - \talkTitle},
	pdfsubject={\talkTitle},
	pdfauthor={Florian Vanhems},
	pdfkeywords={\talkKeywords},
	colorlinks=false
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	set content of title page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{\talkTitle}  
\subtitle{\textbf{\talkSubtitle}} 
\author{Florian Vanhems -- florian.vanhems@univ-lille.fr}
\DTMlangsetup[en-GB]{ord=raise,monthyearsep={,\space}}
\date{\DTMtoday}
\institute{%
	\centering
	\def\svgwidth{.25\textwidth}
	\input{./images/logo_ulille.pdf_tex}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	theorem tools, theorem and proof styles
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setbeamertemplate{theorem}[ams style]
%\setbeamertemplate{theorems}[numbered]

\newcounter{chapter}
\setcounter{chapter}{1}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{definition}
\newtheorem{conclusion}[theorem]{Conclusion}
\newtheorem*{definition}{Definition}
\newtheorem*{remark}{Remark}
\newtheorem*{dummyblock}{dummyblock}

\theoremstyle{example}
\newtheorem{example}[theorem]{Example}

\newenvironment<>{dummyblock}[1]{%
	\setbeamercolor{block title}{fg=white,bg=white}%
	\setbeamercolor{block body}{fg=normal text.fg,bg=white}%
	\begin{block}#2{#1}}{\end{block}}

\begin{document}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}

\renewcommand\theta\vartheta


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	title page
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[plain]
	\titlepage
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	toc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}
	\tableofcontents
\end{frame}

\begin{frame}[fragile]
	\frametitle{Motivations}
	\begin{itemize}
		\item{Critical software of embedded systems}
		\item{EDF is optimal and well understood}
		\item{Experiment with our proof methodology}
	\end{itemize}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Aspirations}
	\begin{itemize}
		\item{Proof of concept - not a production ready scheduler}
		\item{Share our conception and understanding of software proofs}
	\end{itemize}
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	Overview
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Overview}

\highlightedFrame[First formally proven implementation\\of an Earliest Deadline First scheduler for arbitrary sequences of jobs]{}%Claim\\[1cm]}

\begin{frame}[fragile]
	\frametitle{Overview of the scheduler}

	\input{figures/scheduler_overview.tex}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Star of the talk}

	\input{figures/election_function.tex}	
\end{frame}

\begin{frame}[fragile]
	\frametitle{General informations about the scheduler}

	\begin{itemize}
		\item{Schedules arbitrary sequences of jobs (as opposed to \emph{tasks})}
		\item{Periodically called}
		\item{Online \footnote{: while the election function schedules online, our scheduler feeds it hard coded jobs for simplicity}}
	\end{itemize}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Election function of an Earliest Deadline First scheduler}

	\input{figures/scheduler_intro.tex}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	Section proof
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Proofs \& Hypotheses}

\begin{frame}[fragile]
	\frametitle{So what did we prove?}
	\begin{center}
		\huge{Schedulable job sets are scheduled such that\\no job misses its deadline}
	\end{center}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Schedulability property}

	Given any two moments $t, t'$, let $\Gamma_{t, t'}$ be the set of jobs $j$ to schedule in the interval $[t, t']$.\\
	If the sum of the budget $c_j$ of the jobs in that set is less than $t' - t$, then the job set is \emph{schedulable}.

	\begin{definition}[Schedulability property]
	\[
		\forall ~t, t'. ~t < t' \implies \sum_{j \in \Gamma_{t, t'}}c_j \leq t' - t
	\]
	\end{definition}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Well-formedness assumptions}

	For each job :
	\begin{itemize}
		\item{$r_i + c_i \leq d_i$ : the deadline comes late enough for the job to complete its execution if executed alone on the processor}
		\item{$0 < \delta_j \leq c_j$ : the actual duration $\delta$ of a job is strictly positive and less than its budget $c$}
		\item{unique identifiers}
		\item{released exactly once}
	\end{itemize}
\end{frame}

\highlightedFrame[]{Three~~steps~~to~~reach correctness}

\begin{frame}[fragile]
	\frametitle{Earliest Deadline First policy}
	\begin{block}{EDF scheduling policy}
		For any job $j$ and any time instant $t$, if the job $j$ is running at instant $t$, then for any other job $j'$ that is ready to run at the same instant, it holds that $d_j \leq d_{j'}$.
	\end{block}

	\vspace{0.5cm}

	Applying the policy on a job set (up to a certain time instant $t$) is defined as :
	\begin{center}
		EdfPolicyUpTo $t$
	\end{center}
	
	\begin{block}{EDF policy correctnesss property}
	\vspace{-0.2cm}
	\[
		\text{schedulable} \implies \forall j. \forall t.~~\text{EdfPolicyUpTo}~t \implies \neg \text{overdue}~j~t
	\]
	\end{block}

\end{frame}

\begin{frame}[fragile]
	\frametitle{Correctness of an intermediate election function}

	Implement an idealised election function that acts like the one that will be executed.\\[0.5cm]

	The next step is to prove it implements the EDF policy defined previously.

	\begin{block}{Functional election function implements EDF policy}
	\vspace{-0.2cm}
	\[
		\forall t, \forall o, \forall s.~~
		\texttt{idealised\_scheduler}(t) = (o, s) \implies
	\text{EdfPolicyUpTo}~t.
	\]
	\end{block}

	\vspace{0.5cm}

	From this property follows the correctness of this idealised election function.

\end{frame}

\begin{frame}[fragile]
	\frametitle{Correctness of the election function}

	Implement the final, translatable to C, election function \emph{that relies on a chosen set of primitives}.\\[0.5cm]

	The next step is to prove that it acts the same way as the functional one.

	\begin{block}{Actual election function has same effects as functional}
		\vspace{-0.6cm}
		\begin{gather*}
			\forall t.\\
			\{
			    ~\textit{env} = E \land s = \textit{init}~
			\}\\
			(o, s') := \texttt{scheduler}~(t)\\
			\{
			    ~\texttt{idealised\_scheduler}~(t) = (o,s')~
			\}
		\end{gather*}
	\end{block}

	\vspace{0.5cm}

	From this property follows the correctness of the scheduler.

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Models \& Implementation}

\begin{frame}[fragile]
	\frametitle{Overview of the scheduler}

	\input{figures/scheduler_overview.tex}
\end{frame}

\begin{frame}[fragile]
	\frametitle{The scheduler from the proof's point of view}
	\input{figures/model_world.tex}
\end{frame}

\begin{frame}[fragile]
	\frametitle{The actual scheduler}
	\input{figures/implementation.tex}
\end{frame}

\begin{frame}[fragile]
	\frametitle{Most common yet forgotten assumption}
	\begin{center}
		\huge{The models properly describe the behaviour\\ of components we rely on.}
	\end{center}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	thanks slide, not in toc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\sectionNotInTocAndNavigation{Conclusion}

\begin{frame}{Conclusion}

	We have shown an EDF scheduler with a proved election function, describing :
	\begin{itemize}
		\item{The role of the election function, the interface and state, and the back-end}
		\item{The correctness of the election function}
		\item{The assumptions}
		\item{The monadic approach}
	\end{itemize}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%	conclusion frame
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}{Thank you for your attention!}

	Sources \& directions to run the scheduler can be found on our repository :

	\begin{center}\url{https://github.com/2xs/pip_edf_scheduler}\end{center}

	and it passed the artifact validation process
%	\begin{center}
%		\tiny{These slides were created with the \href{https://github.com/vipowueb/minflat-beamer}{\emph{minflat beamer theme}} by Robert Baumgarth}.
%	\end{center}
\end{frame}

\end{document}
